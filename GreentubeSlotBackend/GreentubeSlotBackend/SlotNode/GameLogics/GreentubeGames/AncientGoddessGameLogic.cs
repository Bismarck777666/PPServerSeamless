using GITProtocol;
using SlotGamesNode.GameLogics.BaseClasses;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace SlotGamesNode.GameLogics
{
    internal class AncientGoddessGameLogic : BaseGreenSlotGame
    {
        #region
        protected override string ScatterSymbol
        {
            get
            {
                return "S";
            }
        }

        protected override int MinCountToFreespin
        {
            get
            {
                return 3;
            }
        }

        protected override string VersionCheckString
        {
            get
            {
                return "\b0ÿ2.5.16ÿCasino-Lobbymanager-Serverÿ919ÿ1.10.54.0ÿNGI_GS2_Slot_Serverÿ10701ÿ1.0.0ÿAncient Goddess 95%ÿ1.102.0_2024-02-26_095937ÿ1.88.1";
            }
        }

        protected override string GameUniqueString
        {
            get
            {
                return "\u0006S0ÿA1ÿRÿM,10,10000,1,-1,0ÿI00ÿH,0,0,0,0,0,0ÿ:n,Ancient Goddess 95%ÿ:v,3ÿ:l,-----ÿ:l,^^^^^ÿ:l,_____ÿ:l,^-_-^ÿ:l,_-^-_ÿ:l,-___-ÿ:l,-^^^-ÿ:l,__-^^ÿ:l,^^-__ÿ:l,_---^ÿ:l,^---_ÿ:l,-_-^-ÿ:l,-^-_-ÿ:l,^-^-^ÿ:l,_-_-_ÿ:l,--^--ÿ:l,--_--ÿ:l,^_^_^ÿ:l,_^_^_ÿ:l,_^-^_ÿ:r,0,AJQKKQQAA666JJKK22QQASKKQQ44AJAJKKSQQJJ33KQKQ11AJSAJ555AJAJKKQQAA666JJKK22JJQQASKKQQ44AJAJKKSQQJJ33KQKQ11AJAJ555AJAJKKQQAA666JJKK22QQASKKAAQQ44AJAJKKSQQJJ33KQKQ11ASJAJ555AJÿ:r,0,JQAAKWAKKJJ666QQAA22KKJQQSAKK44JQJQAASKKQQ33AKAK11JQJQ555JQJQAAKWAKKJJ666AQQAA22KKJSAKK44JQJQAASJKKQQ33AKAK11JQJQ555JQJQAAKWAQQKKJJ666QQAA22QKKJSAKK44JQJQAASKKQQ33AKAK11JQJQ555JQÿ:r,0,QKJJAWJAAQQ666KKJJ22AAQQSJAA44QKQKJJSAKK33JAJA11QKQK555QKQKJJAWJAAQQ666KKJJ22AAQQSJAA44QKQKJJSAKK33JAJA11QKJQK555QKQKJJAWJAAQQ666KKJJ22AAQQSJAA44QKQKJJSAKK33JAJA11QKQK555QKÿ:r,0,KAQQKJWQJJKK666AAQQ22JJKSQQJJ44KAKAQQSAJJ33QJQJ11KAKA555KAKAQQJWQJJKKJ666AAQQ22JJKSQQJJ44KAKAQQSAJJ33QJQJ11KAKA555KAKAQQJWQJJKK666AAQQ22JJKSQQJJQ44KAKAQQSAJJ33QJQJ11KJJAKA555KAÿ:r,0,AJSKKQQAA666JJKK22QQASKKQQ44AJAJKKSJQQ33KQKQ11AJAJ555AJAJKKQQAA666JJKKQQ22QQASKKQQ44AJAJKKSJQQ33KQKQ11AJAJ555KKAJAJKKQQAA666JJKK22QQASKKQQ44AJAJKKSJQQJJ33KQKQJJ11AJAJ555AJÿ:r,1,JKK22QQAA11JJKK444QQKKSQQ666JJAA33JJAA555JKK22QQAA11JJKK444QQKKSJJQQ666JJAA33QQJJAA555JKK22QQAA11JJKK444QQKKSQQ666JJAA33JJAAQQ555ÿ:r,1,JJKAAWJKKQQ22JJ11AAQQ444JKKSJJ666AAKK33AAQQ555JJKWJKKQQ22JJ11AAQQ444JKKSJJ666AAKK33AAQQ555JJKWJKKQQ22JJ11AAQQ444JKKSJJ666AAKK33AAQQ555ÿ:r,1,AAQWAQQJJKK22QQ11KKJJ444AAJJSAA666KKQQ33KKJ555AAQWAQQJJ22QQ11KKJJ444AAJJSAA666KKQQ33KKJ555AAQWAQQJJ22QQ11KKJJ444AAJJSAA666JKKQQ33KKJ555ÿ:r,1,QQJKKWQJJKK22JJ11QQAA444KKAASKK666QQJ33AAKKJJ555QQJWQJJKK22JJ11QQAA444JKKAASKK666QQJ33AAJJ555QQJWQJJKK22JJ11QQAA444KKAASKK666QQJ33AAJJ555ÿ:r,1,JKK22QQAA11JJKK444QQKKSQQ666JJAA33JJAA555JKK22QQAA11JJKK444QQKKSJJQQ666JJAA33QQJJAA555JKK22QQAA11JJKK444QQKKSQQ666JJAA33JJAAQQ555ÿ:r,2,JKK22QQAA11JJKK444QQKKSQQ555JJAA33JJAA555JKK22QQAA11JJKK444QQKKSQQ555JJAA33JJAA555JKK22QQAA11QQJJKK444QQKKSQQ555JJAA33JJAA555ÿ:r,2,JJKWJKKQQ22JJ11AAQQ444JKKSJJ555AAKK33AAQQ555JJKWJKKQQ22JJ11AAQQ444JKKSJJ555AAKK33AAQQ555JJKWJKKQQ22JJ11AAQQ444JKKSJJQQ555AAKK33AAQQ555ÿ:r,2,AAQWAQQJJ22QQ11KKJJ444AAJJSAA555KKQQ33KKJ555AAQWAQQJJ22QQ11KKJJ444AAJJSAA555KKQQ33KKJ555AAQWAQQJJ22555QQ11KKJJ444AAJJSAA555KKQQ33KKJ555ÿ:r,2,QQJWQJJKK22JJ11QQAA444KKAASKK555QQJ33AAJJ555QQJWQJJKK22JJ11QQAA444KKAASKK555QQJ33AAJJ555QQJWQJJKK22JJ11QQAA444KKAASKK555QQJ33AAJJ555ÿ:r,2,JKK22QQAA11JJKK444QQKKSQQ555JJAA33JJAA555JKK22QQAA11JJKK444QQKKSQQ555JJAA33JJAA555JKK22QQAA11QQJJKK444QQKKSQQ555JJAA33JJAA555ÿ:r,3,JKK22QQAA11JJKK444AAQQKKSQQ444JJAA33JJAA444JKK22QQAA11JJKK444QQKKSQQ444JJAA33JJAA444JKK22QQAA11JJKK444QQKKSQQ444JJAA33JJAA444ÿ:r,3,JJKWJKKQQ22KKJJ11AAQQ444JKKSJJ444AAKK33AAQQ444JJKWJKKQQ22JJ11AAQQ444JKKSJJ444AAKK33AAQQJ444JJKWJKKQQ22JJ11AAQQ444JKKSAAJJ444AAKK33AAQQ444ÿ:r,3,AAQWAQQJJ22QQ11KKJJ444AAJJSAA444KKQQ33KKQQJ444AAQWAQQJJ22QQ11KKJJ444AAJJSAA444KKQQ33KKJ444AAQWAQQJJKK22QQ11KKJJ444AAJJSAA444AKKQQ33KKJ444ÿ:r,3,QQJWQJJKK22JJ11QQAAJJ444KKAASKK444QQKKJ33AAJJ444QQJKKWQJJKK22AAJJ11QQAA444KKAASKK444QQJ33AAJJ444QQJWQJJ444KK22JJ11QQAA444KKAASKK444QQJ33AAJJ444ÿ:r,3,JKK22QQAA11JJKK444AAQQKKSQQ444JJAA33JJAA444JKK22QQAA11JJKK444QQKKSQQ444JJAA33JJAA444JKK22QQAA11JJKK444QQKKSQQ444JJAA33JJAA444ÿ:r,4,JAAKK22QQAA11JJKK333QQKKSQQ333JJAA33JJAA333JKK22QQAA11JJKK333QQJJKKSQQ333JJAA33JJAA333JKK22QQAA11JJKK333QQKKSQQ333JJAA33JJAA333ÿ:r,4,JJKWJKKQQ22JJ11AAQQ333JKKSJJ333AAKK33AAQQ333JJKWJKKQQ22JJ11AAQQ333JKKSJJ333AAKK33AAQQ333JJKWJKKQQ22JJ11AAQQ333JKKSJJ333AAKK33AAQQ333ÿ:r,4,AAQWAQQJJ3322QQ11KKJJ333AAQQJJSAA333KKQQ33KKJ333AAQWAQQJJ22QQ11KKJJAA333AAJJSAA333KKQQ33KKJAA333AAQWAQQJJ22QQ11KKJJ333AAJJSAA333KKQQ33KKJ333ÿ:r,4,QQKKJWQJJKK22JJ11QQAA333KKAASKK333QQJ33AAJJ333QQJWQJJKK22JJ11QQAA333KKAASKK333QQJ33AAJJ333QQJWQJJKK22JJ11QQAA333KKAASKK333QQJ33AAJJ333ÿ:r,4,JAAKK22QQAA11JJKK333QQKKSQQ333JJAA33JJAA333JKK22QQAA11JJKK333QQJJKKSQQ333JJAA33JJAA333JKK22QQAA11JJKK333QQKKSQQ333JJAA33JJAA333ÿ:r,5,JKK22QQAA11JJKK222QQKKSQQ222JJAA22JJAA222JKK22QQAA11JJKK222QQKKSQQ222JJAA22JJQQAA222JKK22QQAA11JJKK222QQKKSQQ222JJKKAA22JJAA222ÿ:r,5,JJKWJKKQQAA22JJ11AAQQ222JKKSJJ222AAKK22AAQQ222JJKWJKKQQ22JJ11AAQQ222JKKSJJ222AAKK22AAQQJJ222JJKWJKKQQ22JJK11AAQQ222JKKSJJ222AAKK22AAQQ222ÿ:r,5,AAQWAQQJJ22QQ11KKJJ222AAJJSAA222KKQQ22KKJ222AAQWAQQJJ22QQ11KKJJ222AAJJSAA222KKQQ22KKJ222AAQWAQQJJ22QQ11KKJJ222AAJJSAA222KKQQ22KKJ222ÿ:r,5,QQJWQJJKK22JJ11QQAA222KKAASKK222QQJ22AAJJ222QQJWQJJAAKK22JJ11QQAA222KKAASKK222QQJ22AAJJ222QQJWQJJKK22JJ11QQAA222KKAASKK222QQJ22AAJJ222ÿ:r,5,JKK22QQAA11JJKK222QQKKSQQ222JJAA22JJAA222JKK22QQAA11JJKK222QQKKSQQ222JJAA22JJQQAA222JKK22QQAA11JJKK222QQKKSQQ222JJKKAA22JJAA222ÿ:r,6,JKK11QQAA11JJKK111QQKKSQQ111JJAA11JJAA111JKK11QQAA11JJKK111AAQQKKSQQ111JJAA11JJAA111JKK11QQAA11JJKK111QQKKSQQ111JJAA11JJAA111ÿ:r,6,JJKWJKKQQ11JJ11AAQQ111JKKSJJ111AAKK11AAQQ111JJKWJKKQQ11JJ11AAQQ111JKKSJJ111AAKK11AAQQ111JJKWJKKQQ11JJ11AAQQ111JKKSJJ111AAKK11AAQQ111ÿ:r,6,AAQWAQQJJ11QQ11KKJJ111AAQQJJSAA111KKAAQQ11KKJ111AAQ111WAQQJJ11QQ11KKJJ111AAJJQSAA111KKQQ11AAKKJ111AAQWAQQJJ11QQ11KKJJ111AAJJSQQAA111KKQQ11KKJ111ÿ:r,6,QQJWAAQJJKK11JJ11QQAA111KKJJAASKK111QQJ11AAJJ111QQJWQJJKK11JJ11QQAAJ111KKAASKKJJ111QQJ11AAJJKK111QQJWQJJKK11JJ11QQAA111KKAASKK111QQJ11AAJJ111ÿ:r,6,JKK11QQAA11JJKK111QQKKSQQ111JJAA11JJAA111JKK11QQAA11JJKK111AAQQKKSQQ111JJAA11JJAA111JKK11QQAA11JJKK111QQKKSQQ111JJAA11JJAA111ÿ:j,W,1,0,123456AKQJÿ:u,APPPP.PP.PP.PPPPÿ:w,S,3,-2,0ÿ:w,S,4,-20,0ÿ:w,S,5,-50,0ÿ:w,1,3,100,0ÿ:w,1,4,250,0ÿ:w,1,5,500,0ÿ:w,2,3,50,0ÿ:w,2,4,200,0ÿ:w,2,5,400,0ÿ:w,3,3,20,0ÿ:w,3,4,125,0ÿ:w,3,5,300,0ÿ:w,4,3,20,0ÿ:w,4,4,100,0ÿ:w,4,5,250,0ÿ:w,5,3,10,0ÿ:w,5,4,50,0ÿ:w,5,5,200,0ÿ:w,6,3,10,0ÿ:w,6,4,50,0ÿ:w,6,5,200,0ÿ:w,A,3,5,0ÿ:w,A,4,20,0ÿ:w,A,5,100,0ÿ:w,K,3,5,0ÿ:w,K,4,20,0ÿ:w,K,5,100,0ÿ:w,Q,3,5,0ÿ:w,Q,4,20,0ÿ:w,Q,5,100,0ÿ:w,J,3,5,0ÿ:w,J,4,20,0ÿ:w,J,5,100,0ÿ:wa,S,3,-2,0,0,0,0:1,-1,0ÿ:wa,S,4,-20,0,0,0,0:1,-1,0ÿ:wa,S,5,-50,0,0,0,0:1,-1,0ÿ:wa,1,3,100,0,0,0,0:1,-1,0ÿ:wa,1,4,250,0,0,0,0:1,-1,0ÿ:wa,1,5,500,0,0,0,0:1,-1,0ÿ:wa,2,3,50,0,0,0,0:1,-1,0ÿ:wa,2,4,200,0,0,0,0:1,-1,0ÿ:wa,2,5,400,0,0,0,0:1,-1,0ÿ:wa,3,3,20,0,0,0,0:1,-1,0ÿ:wa,3,4,125,0,0,0,0:1,-1,0ÿ:wa,3,5,300,0,0,0,0:1,-1,0ÿ:wa,4,3,20,0,0,0,0:1,-1,0ÿ:wa,4,4,100,0,0,0,0:1,-1,0ÿ:wa,4,5,250,0,0,0,0:1,-1,0ÿ:wa,5,3,10,0,0,0,0:1,-1,0ÿ:wa,5,4,50,0,0,0,0:1,-1,0ÿ:wa,5,5,200,0,0,0,0:1,-1,0ÿ:wa,6,3,10,0,0,0,0:1,-1,0ÿ:wa,6,4,50,0,0,0,0:1,-1,0ÿ:wa,6,5,200,0,0,0,0:1,-1,0ÿ:wa,A,3,5,0,0,0,0:1,-1,0ÿ:wa,A,4,20,0,0,0,0:1,-1,0ÿ:wa,A,5,100,0,0,0,0:1,-1,0ÿ:wa,K,3,5,0,0,0,0:1,-1,0ÿ:wa,K,4,20,0,0,0,0:1,-1,0ÿ:wa,K,5,100,0,0,0,0:1,-1,0ÿ:wa,Q,3,5,0,0,0,0:1,-1,0ÿ:wa,Q,4,20,0,0,0,0:1,-1,0ÿ:wa,Q,5,100,0,0,0,0:1,-1,0ÿ:wa,J,3,5,0,0,0,0:1,-1,0ÿ:wa,J,4,20,0,0,0,0:1,-1,0ÿ:wa,J,5,100,0,0,0,0:1,-1,0ÿ:s,0ÿ:i,1ÿ:i,5ÿ:i,10ÿ:i,15ÿ:i,20ÿ:m,1,5,10,15,20ÿ:a,0,0ÿ:g,999,1000,-1,false,0,falseÿ:es,0,0ÿ:mbnr,0.0ÿ:fs,0,0,0,0,0ÿbs,0,1,0ÿ:k,nullÿe,20,0,4,-1ÿb,0,0,0ÿs,1ÿr,0,5,51,36,26,51,13ÿx,1,1ÿrw,0";
            }
        }
        #endregion

        public AncientGoddessGameLogic()
        {
            _gameID = GAMEID.AncientGoddess;
            GameName = "AncientGoddess";
        }
        
        protected override string buildLineBetString(string strGlobalUserID, double balance)
        {
            return string.Format("\u0006S{0}ÿA0ÿC,100.0,,1,ÿT,0,0,0ÿRÿM,1,3000,1,-1,0ÿI00ÿH,0,0,0,0,0,0ÿY,7200,10ÿ:i,1ÿ:i,5ÿ:i,10ÿ:i,15ÿ:i,20ÿ:m,1,5,10,15,20ÿ:b,15,1,2,3,4,5,8,10,15,20,30,40,50,80,100,150ÿ:a,0,0ÿ:g,999,1000,-1,false,0,falseÿ:es,0,0ÿ:mbnr,1.0ÿbs,0,1,0ÿ:k,nullÿe,{1},{2},{3},-1ÿb,1000,1000,0ÿs,1ÿr,0,5,51,36,26,51,13ÿx,1,1ÿrw,0", balance, !_dicUserBetInfos.ContainsKey(strGlobalUserID) ? this._defaultLine : _dicUserBetInfos[strGlobalUserID].PlayLine, !_dicUserBetInfos.ContainsKey(strGlobalUserID) ? this._defaultBetPerLine : (_dicUserBetInfos[strGlobalUserID].PlayBet / _dicUserBetInfos[strGlobalUserID].PlayLine), !_dicUserBetInfos.ContainsKey(strGlobalUserID) ? Array.IndexOf(_supportLines, this._defaultLine) : Array.IndexOf(_supportLines, _dicUserBetInfos[strGlobalUserID].PlayLine));
        }

        protected override void onDoInit(string strGlobalUserID, GITMessage message, double balance, Currencies currency)
        {
            try
            {
                GITMessage resMessage = new GITMessage((ushort)SCMSG_CODE.SC_GREENTUBE_DOINIT);
                resMessage.Append("%t0ÿq0");
                resMessage.Append(VersionCheckString);
                foreach (string currencyName in SupportCurrencyList)
                {
                    resMessage.Append(currencyName);
                }
                resMessage.Append(buildInitString(strGlobalUserID, balance, currency));
                resMessage.Append("\vGAMEVARIATIONÿ665ÿTICKETSÿ1");
                resMessage.Append(GameUniqueString);
                resMessage.Append("%t0ÿq0");
                resMessage.Append($"\aNATIVEJACKPOTCURRENCYFACTORÿ100.0ÿMAXBUYINTOTALÿ0ÿNEEDSSESSIONTIMEOUTÿ0ÿRELIABILITYÿ0ÿNICKNAMEÿ155258EURÿIDÿ155258ÿISDEEPWALLETÿ0ÿCURRENCYFACTORÿ100.0ÿMINBUYINÿ1ÿSESSIONTIMEOUTMINUTESÿ60ÿJACKPOT_PROGRESSIVE_CAPÿ0.0ÿNATIVEJACKPOTCURRENCYÿ{getCurrencyCode(currency)}ÿEXTUSERIDÿDummyDB_ExternalUserId_155258EURÿFREESPINSISCAPREACHEDÿ0ÿCURRENCYÿ{getCurrencySymbol(currency)}ÿTICKETSÿ0ÿJACKPOT_TOTAL_CAPÿ0.0ÿJACKPOTFEEPERCENTAGEÿ0.0ÿISSHOWJACKPOTCONTRIBUTIONÿ0");
                resMessage.Append(buildLineBetString(strGlobalUserID, balance));

                ToUserMessage toUserMessage = new ToUserMessage((int)_gameID, resMessage);

                Sender.Tell(toUserMessage, Self);
            }
            catch (Exception ex)
            {
                _logger.Error("Exception has been occurred in BaseGreentubeSlotGame::onDoInit GameID: {0}, {1}", _gameID, ex);
            }
        }
        protected override void onBalanceConfirm(string strGlobalUserID, GITMessage message, double balance, Currencies currency)
        {
            try
            {
                GITMessage resMessage = new GITMessage((ushort)SCMSG_CODE.SC_GREENTUBE_BALANCECONFIRM);
                resMessage.Append("%t0ÿq0");
                resMessage.Append($"\aNATIVEJACKPOTCURRENCYFACTORÿ100.0ÿMAXBUYINTOTALÿ0ÿNEEDSSESSIONTIMEOUTÿ0ÿRELIABILITYÿ0ÿNICKNAMEÿ155258EURÿIDÿ155258ÿISDEEPWALLETÿ0ÿCURRENCYFACTORÿ100.0ÿMINBUYINÿ1ÿSESSIONTIMEOUTMINUTESÿ60ÿJACKPOT_PROGRESSIVE_CAPÿ0.0ÿNATIVEJACKPOTCURRENCYÿ{getCurrencyCode(currency)}ÿEXTUSERIDÿDummyDB_ExternalUserId_155258EURÿFREESPINSISCAPREACHEDÿ0ÿCURRENCYÿ{getCurrencySymbol(currency)}ÿTICKETSÿ0ÿJACKPOT_TOTAL_CAPÿ0.0ÿJACKPOTFEEPERCENTAGEÿ0.0ÿISSHOWJACKPOTCONTRIBUTIONÿ0");
                resMessage.Append(buildLineBetString(strGlobalUserID, balance));
                ToUserMessage toUserMessage = new ToUserMessage((int)_gameID, resMessage);

                Sender.Tell(toUserMessage, Self);
            }
            catch (Exception ex)
            {
                _logger.Error("Exception has been occurred in BaseGreentubeSlotGame::onDoInit GameID: {0}, {1}", _gameID, ex);
            }
        }
    }
}

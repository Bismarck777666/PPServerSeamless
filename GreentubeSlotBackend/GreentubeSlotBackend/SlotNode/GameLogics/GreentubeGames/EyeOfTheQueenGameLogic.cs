using GITProtocol;
using SlotGamesNode.GameLogics.BaseClasses;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace SlotGamesNode.GameLogics
{
    internal class EyeOfTheQueenGameLogic : BaseGreenSlotGame
    {
        #region
        protected override string ScatterSymbol
        {
            get
            {
                return "S";
            }
        }

        protected override int MinCountToFreespin
        {
            get
            {
                return 3;
            }
        }

        protected override string VersionCheckString
        {
            get
            {
                return "\b0ÿ2.5.16ÿCasino-Lobbymanager-Serverÿ919ÿ1.10.54.0ÿNGI_GS2_Slot_Serverÿ11786ÿ1.0.0ÿEye of the Queen 95%ÿ1.102.0_2024-02-26_095937ÿ1.88.1";
            }
        }

        protected override string GameUniqueString
        {
            get
            {
                return "\u0006S0ÿA1ÿRÿM,10,10000,2,-1,0ÿI00ÿH,0,0,0,0,0,0ÿ:n,Eye of the Queen 95%ÿ:v,3ÿ:l,-----ÿ:l,^^^^^ÿ:l,_____ÿ:l,^-_-^ÿ:l,_-^-_ÿ:l,-___-ÿ:l,-^^^-ÿ:l,__-^^ÿ:l,^^-__ÿ:l,_---^ÿ:r,0,KK55AA33KKK66AASAA44KKK11AAA22QQQ555AA33KKSKK666AA44JJJ22KK55AA33KKK66AASAA44KKK11KKAAA22QQQ555AA33KKSKK666AA44JJJ22KK55AA33KKK66AASAA44KKK11AAA22QQQ555AA33KKSKK666AA44JJJ22ÿ:r,0,JJ55QQWQQ33JJJ66QQSQQ44AAA11QQQ22JJJ555QQ33JJSJJ666QQ44KKK22JJ55QQWQQ33JJJ66QQSQQ44AAA11QQQ22JJJ555QQ33JJSJJ666QQ44KKK22JJ55QQWQQ33JJJ66QQSQQ44AAA11QQQ22JJJ555QQ33JJSJJ666QQ44JJJKKK22ÿ:r,0,QQ55JJWJJ33AA66JJSJJ44QQQ11JJJ22QQQ555AA33QQSQQ666JJ44KKK22QQ55JJWJJ33AA66JJSJJ44QQQ11JJJQQ22QQQ555AA33QQSQQ666JJQQQ44KKK22QQ55JJWJJ33AA66JJSJJ44QQQ11JJJ22QQQ555AA33QQSQQ666JJ44KKK22ÿ:r,0,AA55KKWKK33QQ66KKSKK44AAA11QQ22AA555AAKK33AASAA666QQ44JJJ22AA55KKWKK33QQ66KKSKK44AAA11QQ22AA555KK33AASAA666QQ44JJJ22AA55KKWKK33QQ66KKSKK44AAA11QQ22AA555KK33AASAA666QQ44JJJ22ÿ:r,0,KK55QQ33KKK66QQSQQ44JJJ11AA22JJJ555QQ33JJSJJ666AA44QQQ22KK55QQ33KKK66QQSQQ44JJJ11AA22JJJ555QQ33JJSJJ666AA44QQQ22KK55QQ33KKK66QQSQQ44JJJ11AA22JJJ555JJQQ33JJSJJ666AAJJ44QQQ22ÿ:r,1,KK55AA33KK66AASAA44KK11AA22QQQ555AA33KKSKK666AA44JJJ22KK55AA33KK66AASAA44AAKK11AA22QQQ555AA33KKSKK666AA44JJJ22KK55AA33KK66AASAA44KK11AA22QQQ555AA33KKSKK666AA44JJJ22ÿ:r,1,JJ55QQWQQ33JJ66QQSJJQQ44AAAJJ11QQ22JJ555QQ33JJSJJ666QQ44KKK22JJ55QQWQQ33JJ66QQSQQ44AAA11QQ22JJ555QQ33JJSJJ666QQ44KKK22JJ55QQWQQ33JJ66QQSQQ44AAA11QQ22JJ555QQ33JJSJJ666QQ44KKK22ÿ:r,1,QQ55JJWJJ33AA66JJSJJ44QQ11JJ22QQ555AA33QQSQQ666JJ44KKK22QQ55JJWJJ33AAJJ66JJSJJ44QQ11JJ22QQ555AA33QQSQQ666JJ44KKK22QQ55JJWJJ33AA66JJSJJ44QQ11JJ22QQ555AA33QQSQQ666JJ44KKK22ÿ:r,1,AA55KKWKK33QQ66KKSKK44AA11QQ22AA555KK33AASAA666QQ44JJJ22AA55KKWKK33QQ66KKSKK44AA11QQ22AA555KK33AASAA666QQ44JJJ22AA55KKWKK33QQ66KKAASKK44AA11QQ22AA555KK33AASAA666QQ44JJJ22ÿ:r,1,KK55QQ33KKK66QQSQQ44JJJ11AA22JJJ555QQ33JJSJJ666AA44QQQ22KK55QQ33KKK66QQSQQ44JJJ11AA22JJJ555QQ33JJSJJ666AA44QQQ22KK55QQ33KKK66QQSQQ44JJJ11AA22JJJ555JJQQ33JJSJJ666AAJJ44QQQ22ÿ:r,2,AA22KK666AA1KK55QQ333AASKK66AA1KK555JJ444AA22KK666AA1KK55QQ333AASKK66AA1KK555JJ444AA22KK666AA1KK55QQ333AASKK66AA1KK555JJ444ÿ:r,2,QQ22AAWAA666KK1AA55KK333JJSAA66KK1AA555KK444QQ22AAWAA666KK1AA55KK333JJSAA66KK1AA555KK444QQ22AAWAA666KK1AA55KK333JJSAA66KK1AA555KK444ÿ:r,2,KK22JJWJJ666AA1KK55AA333KKSQQ66AA1KK555AA444KK22JJWJJ666AA1KK55AA333KKSQQ66AA1KK555AA444KK22JJWJJ666AA1KK55AA333KKSQQ66AA1KK555AA444ÿ:r,2,AA22KKWKK666QQ1AA55KK333AASKK66JJ1AA555KK444AA22KKWKK666QQ1AA55KK333AASKK66JJ1AA555KK444AA22KKWKK666QQ1AA55KK333AASKK66JJ1AAKK555KK444ÿ:r,2,KK22AA666KK1JJ55AA333KKSAA66KK1QQ555AA444KK22AA666KK1JJ55AA333KKSAA66KK1QQ555AA444KK22AA666KK1JJ55AA333KKSAA66KK1QQ555AA444ÿ:r,3,AA22KK555AA1KK55QQ333AASKK55AA1KK555JJ444AA22KK555AA1KK55QQ333AASKK55AA1KK555JJ444AA22KK555AA1KK55QQ333AASKK55AA1KK555JJ444ÿ:r,3,QQ22AAWAA555KK1AA55KK333JJSAA55KK1AA555KK444QQ22AAWAA555KK1AA55KK333JJSAA55KK1AA555KK444QQ22AAWAA555KK1AA55KK333JJSAA55KK1AA555KK444ÿ:r,3,KK22JJWJJ555AA1KK55AA333KKSQQ55AA1KK555AA444KK22JJWJJ555AA1KK55AA333KKJJSQQ55AA1KK555AA444KK22JJWJJ555AA1KK55AA333KKSQQ55AA1KK555AA444ÿ:r,3,AA22KKWKK555QQ1AA55KK333AASKK55JJ1AA555KK444AA22KKWKK555QQ1AA55KK333AASKK55JJ1AA555KK444AA22KKWKK555QQ1AA55KK333AASKK55JJ1AA555KK444ÿ:r,3,KK22AA555KK1JJ55AA333KKSAA55KK1QQ555AA444KK22AA555KK1JJ55AA333KKSAA55KK1QQ555AA444KK22AA555KK1JJ55AA333KKSAA55KK1QQ555AA444ÿ:r,4,AA22KK444AA1KK44QQ333AASJJ44QQ1KK444JJ444AA22KK444AA1KK44QQ333AASJJ44QQ1KK444JJ444AA22KK444AA1KK44QQ333AASJJ44QQ1KK444JJ444ÿ:r,4,QQ22AAWAA444JJ1QQ44KK333JJSAA44KK1AA444KKAA444QQ22AAWAA444JJ1QQ44KK333JJSAA44KK1AA444KK444QQ22AAWAA444JJ1QQ44KK333JJSAA44KK1AA444KK444ÿ:r,4,KK22JJWQQJJ444AA1KKJJ44AA333KKSQQ44AA1JJ444QQAA444KK22JJWJJ444AA1KK44AAJJ333KKSQQ44AA1JJ444QQ444KK22JJWJJ444AA1KK44AA333KKSQQ44AA1JJ444QQ444ÿ:r,4,AA22KKWKK444QQ1AA44JJ333QQSKK44JJ1AA444KKQQ444AA22KKWKK444QQ1AA44JJ333QQSKK44JJ1AA444KK444AA22KKWKK444QQ1AA44JJ333QQSKK44JJ1AA444KK444ÿ:r,4,JJ22QQ444KK1JJ44AA333KKSAA44KK1QQ444AA444JJ22QQ444KK1JJ44AA333KKSAA44KK1QQ444AA444JJ22QQ444KK1JJ44AA333KKSAA44KK1QQ444AA444ÿ:r,5,AA22KK333AA1KK33QQQ33AASJJ33QQ1KK333JJ333AA22KK333AA1KK33QQQ33AASJJ33QQ1KK333JJ333AA22KK333AA1KK33QQQ33AASJJ33QQ1KK333JJ333ÿ:r,5,QQ22AAWAA333JJ1QQ33KK333JJSAA33KK1AAJJ333KK33QQQ22AAWAA333JJ1QQ33KK333JJSAA33KK1AA333KK33QQQ22AAWAA333JJ1QQ33KK333JJSAA33KK1AA333KK33Qÿ:r,5,KK22JJWJJ333AA1KK33AA333KKSQQ33AA1JJ33QQQ333KK22JJWJJ333AA1KK33AA333KKSQQ33AA1JJ33QQQ333KK22JJWJJ333AA1KK33AA333KKSQQ33AA1JJ33QQQ333ÿ:r,5,AA22KKWKK333QQ331AA33JJ33QQQSKK33JJ1AA333KK333AA22KKWKK333QQ1AA33JJ33QQQSKK33JJ1AA333KK333AA22KKWKK333QQ1AA33JJ33QQQSKK33JJ1AA333KK333ÿ:r,5,JJ22QQ333KK1JJ33AA333KKSAA33KK1QQQ33AA333JJ22QQ333KK1JJ33AA333KKSAA33KK3331QQQ33AA333JJ22QQ333KK1JJ33AA333KKSAA33KK1QQQ33AA333ÿ:r,6,AA22KK22AA1KK2QQ22AASJJJ22QQ1KK22JJJ2QQ22AA22KK22AA1KK2QQ22AASJJJ22QQ1KK22JJJ2QQ22AA22KK22AA1KK2QQ22AASJJJ22QQ1KK22JJJ2QQ22ÿ:r,6,QQQ22AAWAA22JJ1QQQ2KK22JJSAA22KK1AA22KK2JJ22QQQ22AAWAA22JJ1QQQAA2KK22JJSAA22KK1AA22KK2JJ22QQQ22AAWAA22JJ1QQQ2KK22JJSAA22KK1AA22KK2JJ22ÿ:r,6,KK22JJWJJ22AA1KK2AA22KKSQQQ22AA1JJ22QQQ2JJ22KK22JJWJJ22AA1KK2AA22KKSQQQ22AA1JJ22QQQ2JJ22KK22JJWJJ22AA1KK2AA22KKSQQQ22AA1JJKK22QQQ2JJ22ÿ:r,6,AA22KKWKK22QQ1AA2JJJ22QQSKK22JJJ1KKAA22KK2QQ22AA22KKWKK22QQ1AA2JJJ22QQSKK22JJJ1AA22KK2QQ22AA22KKWJJJKK22QQ1AA2JJJ22QQSKK22JJJ1AA22KK2QQ22ÿ:r,6,JJJ22QQ22KK1JJJQQ2AA22KKSAA22KK1QQ22AA2QQ22JJJ22QQ22KK1JJJ2AA22KKSAA22KK1QQ22AA2QQ22JJJ22QQ22KK1JJJ2AA22KKSAA22KK1QQ22AA2QQ22ÿ:r,7,AA11KK1AA1KK1QQ11AAS1JJJ1QQ1KK11JJJ1QQ1JJ1AA11KK1AA1KK1QQ11AASJJJ1QQ1KK11JJJ1QQ1KKJJ1AA11KK1AA1KK1QQ11AASJJJ1QQ1KK11JJJ1QQ1JJ1ÿ:r,7,QQQ11AAWAA1JJ1QQQ1KK11JJSAA1AAKK1AA11AAJJ1KK1JJ1QQQ11AAWAA1JJ1QQQ1KK11JJSAA1KK1AA11JJ1AAKK1JJ1QQQ11AAWAA1JJ1QQQ1KK11JJSAA1KK1AA11JJ1KK1JJ1ÿ:r,7,KK11JJWJJ1AA1JJKK1JJ11KKSQQQ1AA1JJ11QQQ1JJ1AA1KK11JJWJJ1AA1KK1JJ11KKSQQQ1AA1JJ11QQQ1JJ1AA1KK11JJWJJ1AA1KK1JJ11KKSQQQ1AA1JJ11QQQ1JJ1AA1ÿ:r,7,AA11KKWKK11QQ1AA1JJ11QQSKK1JJJ1AA11KK1QQ1JJ1AA11KK1WKK11QQ1AA1JJ11QQSKK1JJJ1AA11KK1QQ1JJ1AA11KKWKK11QQ1AA1JJ11QQSKK1JJJ1AA11KK1QQ1JJ1ÿ:r,7,JJJ11QQ11KK1JJ1AA11KKSAA1KK1QQ11AA1JJ1QQ1JJJ11QQ11KK1JJ1AA11KKSAA1KK1QQ11AA1JJ1QQ1JJJ11QQ11KK1JJ1AA11KKSAA1KK1QQ11AA1JJ1QQ1ÿ:j,W,1,0,123456AKQJÿ:u,APPPP.PP.PP.PPPPÿ:w,S,3,-2,0ÿ:w,S,4,-20,0ÿ:w,S,5,-50,0ÿ:w,1,3,100,0ÿ:w,1,4,250,0ÿ:w,1,5,500,0ÿ:w,2,3,50,0ÿ:w,2,4,200,0ÿ:w,2,5,400,0ÿ:w,3,3,20,0ÿ:w,3,4,125,0ÿ:w,3,5,300,0ÿ:w,4,3,20,0ÿ:w,4,4,100,0ÿ:w,4,5,250,0ÿ:w,5,3,10,0ÿ:w,5,4,50,0ÿ:w,5,5,200,0ÿ:w,6,3,10,0ÿ:w,6,4,50,0ÿ:w,6,5,200,0ÿ:w,A,3,5,0ÿ:w,A,4,20,0ÿ:w,A,5,100,0ÿ:w,K,3,5,0ÿ:w,K,4,20,0ÿ:w,K,5,100,0ÿ:w,Q,3,5,0ÿ:w,Q,4,20,0ÿ:w,Q,5,100,0ÿ:w,J,3,5,0ÿ:w,J,4,20,0ÿ:w,J,5,100,0ÿ:wa,S,3,-2,0,0,0,0:1,-1,0ÿ:wa,S,4,-20,0,0,0,0:1,-1,0ÿ:wa,S,5,-50,0,0,0,0:1,-1,0ÿ:wa,1,3,100,0,0,0,0:1,-1,0ÿ:wa,1,4,250,0,0,0,0:1,-1,0ÿ:wa,1,5,500,0,0,0,0:1,-1,0ÿ:wa,2,3,50,0,0,0,0:1,-1,0ÿ:wa,2,4,200,0,0,0,0:1,-1,0ÿ:wa,2,5,400,0,0,0,0:1,-1,0ÿ:wa,3,3,20,0,0,0,0:1,-1,0ÿ:wa,3,4,125,0,0,0,0:1,-1,0ÿ:wa,3,5,300,0,0,0,0:1,-1,0ÿ:wa,4,3,20,0,0,0,0:1,-1,0ÿ:wa,4,4,100,0,0,0,0:1,-1,0ÿ:wa,4,5,250,0,0,0,0:1,-1,0ÿ:wa,5,3,10,0,0,0,0:1,-1,0ÿ:wa,5,4,50,0,0,0,0:1,-1,0ÿ:wa,5,5,200,0,0,0,0:1,-1,0ÿ:wa,6,3,10,0,0,0,0:1,-1,0ÿ:wa,6,4,50,0,0,0,0:1,-1,0ÿ:wa,6,5,200,0,0,0,0:1,-1,0ÿ:wa,A,3,5,0,0,0,0:1,-1,0ÿ:wa,A,4,20,0,0,0,0:1,-1,0ÿ:wa,A,5,100,0,0,0,0:1,-1,0ÿ:wa,K,3,5,0,0,0,0:1,-1,0ÿ:wa,K,4,20,0,0,0,0:1,-1,0ÿ:wa,K,5,100,0,0,0,0:1,-1,0ÿ:wa,Q,3,5,0,0,0,0:1,-1,0ÿ:wa,Q,4,20,0,0,0,0:1,-1,0ÿ:wa,Q,5,100,0,0,0,0:1,-1,0ÿ:wa,J,3,5,0,0,0,0:1,-1,0ÿ:wa,J,4,20,0,0,0,0:1,-1,0ÿ:wa,J,5,100,0,0,0,0:1,-1,0ÿ:s,0ÿ:i,1ÿ:i,2ÿ:i,3ÿ:i,4ÿ:i,5ÿ:i,6ÿ:i,7ÿ:i,8ÿ:i,9ÿ:i,10ÿ:m,1,2,3,4,5,6,7,8,9,10ÿ:a,0,0ÿ:g,999,1000,-1,false,0,falseÿ:es,0,0ÿ:mbnr,0.0ÿ:fs,0,0,0,0,0ÿbs,0,1,0ÿ:k,nullÿe,10,0,9,-1ÿb,0,0,0ÿs,1ÿr,1,5,50,59,8,15,11ÿx,1,1ÿrw,0";
            }
        }
        #endregion

        public EyeOfTheQueenGameLogic()
        {
            _gameID = GAMEID.EyeOfTheQueen;
            GameName = "EyeOfTheQueen";
        }
        
        protected override string buildLineBetString(string strGlobalUserID, double balance)
        {
            return string.Format("\u0006S{0}ÿA0ÿC,100.0,,1,ÿT,0,0,0ÿRÿM,2,3000,2,-1,0ÿI00ÿH,0,0,0,0,0,0ÿY,7200,10ÿ:i,1ÿ:i,2ÿ:i,3ÿ:i,4ÿ:i,5ÿ:i,6ÿ:i,7ÿ:i,8ÿ:i,9ÿ:i,10ÿ:m,1,2,3,4,5,6,7,8,9,10ÿ:b,16,2,3,4,5,8,10,15,20,30,40,50,80,100,150,200,300ÿ:a,0,0ÿ:g,999,1000,-1,false,0,falseÿ:es,0,0ÿ:mbnr,2.0ÿbs,0,1,0ÿ:k,nullÿe,{1},{2},{3},-1ÿb,1000,1000,0ÿs,1ÿr,1,5,50,59,8,15,11ÿx,1,1ÿrw,0", balance, !_dicUserBetInfos.ContainsKey(strGlobalUserID) ? this._defaultLine : _dicUserBetInfos[strGlobalUserID].PlayLine, !_dicUserBetInfos.ContainsKey(strGlobalUserID) ? this._defaultBetPerLine : (_dicUserBetInfos[strGlobalUserID].PlayBet / _dicUserBetInfos[strGlobalUserID].PlayLine), !_dicUserBetInfos.ContainsKey(strGlobalUserID) ? Array.IndexOf(_supportLines, this._defaultLine) : Array.IndexOf(_supportLines, _dicUserBetInfos[strGlobalUserID].PlayLine));
        }

        protected override void onDoInit(string strGlobalUserID, GITMessage message, double balance, Currencies currency)
        {
            try
            {
                GITMessage resMessage = new GITMessage((ushort)SCMSG_CODE.SC_GREENTUBE_DOINIT);
                resMessage.Append("%t0ÿq0");
                resMessage.Append(VersionCheckString);
                foreach (string currencyName in SupportCurrencyList)
                {
                    resMessage.Append(currencyName);
                }
                resMessage.Append(buildInitString(strGlobalUserID, balance, currency));
                resMessage.Append("\vGAMEVARIATIONÿ665ÿTICKETSÿ1");
                resMessage.Append(GameUniqueString);
                resMessage.Append("%t0ÿq0");
                resMessage.Append($"\aNATIVEJACKPOTCURRENCYFACTORÿ100.0ÿMAXBUYINTOTALÿ0ÿNEEDSSESSIONTIMEOUTÿ0ÿRELIABILITYÿ0ÿNICKNAMEÿ155258EURÿIDÿ155258ÿISDEEPWALLETÿ0ÿCURRENCYFACTORÿ100.0ÿMINBUYINÿ1ÿSESSIONTIMEOUTMINUTESÿ60ÿJACKPOT_PROGRESSIVE_CAPÿ0.0ÿNATIVEJACKPOTCURRENCYÿ{getCurrencyCode(currency)}ÿEXTUSERIDÿDummyDB_ExternalUserId_155258EURÿFREESPINSISCAPREACHEDÿ0ÿCURRENCYÿ{getCurrencySymbol(currency)}ÿTICKETSÿ0ÿJACKPOT_TOTAL_CAPÿ0.0ÿJACKPOTFEEPERCENTAGEÿ0.0ÿISSHOWJACKPOTCONTRIBUTIONÿ0");
                resMessage.Append(buildLineBetString(strGlobalUserID, balance));

                ToUserMessage toUserMessage = new ToUserMessage((int)_gameID, resMessage);

                Sender.Tell(toUserMessage, Self);
            }
            catch (Exception ex)
            {
                _logger.Error("Exception has been occurred in BaseGreentubeSlotGame::onDoInit GameID: {0}, {1}", _gameID, ex);
            }
        }
        protected override void onBalanceConfirm(string strGlobalUserID, GITMessage message, double balance, Currencies currency)
        {
            try
            {
                GITMessage resMessage = new GITMessage((ushort)SCMSG_CODE.SC_GREENTUBE_BALANCECONFIRM);
                resMessage.Append("%t0ÿq0");
                resMessage.Append($"\aNATIVEJACKPOTCURRENCYFACTORÿ100.0ÿMAXBUYINTOTALÿ0ÿNEEDSSESSIONTIMEOUTÿ0ÿRELIABILITYÿ0ÿNICKNAMEÿ155258EURÿIDÿ155258ÿISDEEPWALLETÿ0ÿCURRENCYFACTORÿ100.0ÿMINBUYINÿ1ÿSESSIONTIMEOUTMINUTESÿ60ÿJACKPOT_PROGRESSIVE_CAPÿ0.0ÿNATIVEJACKPOTCURRENCYÿ{getCurrencyCode(currency)}ÿEXTUSERIDÿDummyDB_ExternalUserId_155258EURÿFREESPINSISCAPREACHEDÿ0ÿCURRENCYÿ{getCurrencySymbol(currency)}ÿTICKETSÿ0ÿJACKPOT_TOTAL_CAPÿ0.0ÿJACKPOTFEEPERCENTAGEÿ0.0ÿISSHOWJACKPOTCONTRIBUTIONÿ0");
                resMessage.Append(buildLineBetString(strGlobalUserID, balance));
                ToUserMessage toUserMessage = new ToUserMessage((int)_gameID, resMessage);

                Sender.Tell(toUserMessage, Self);
            }
            catch (Exception ex)
            {
                _logger.Error("Exception has been occurred in BaseGreentubeSlotGame::onDoInit GameID: {0}, {1}", _gameID, ex);
            }
        }
    }
}
